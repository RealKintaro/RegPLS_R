library(data.table)
library(Hmisc)
library(pls)
library(MASS)
path2data<-file.path("c:","Users","makch","STUDIES",
"s3","ADD","RegPLSR")
DM.dt <- fread(file.path(path2data, "Data_Cornell.csv"))
# Regression multiple Y f(X1..X7)
lm<-lm(formula = Y ~ 0 + X1 + X2+ X3 + X4 + X5 +X6 + X7,
data=DM.dt)
#print
print(lm)
#summary
print(summary(lm))
DM_Matrix<-as.matrix(DM.dt)
rcorr(DM_Matrix, type=c("pearson","spearman"))
rcorr(DM_Matrix, type="spearman")
Scale_DM<-scale(DM.dt)
colnames(Scale_DM)<- c("X1_cn","X2_cn","X3_cn","X4_cn","X5_cn",
"X6_cn","X7_cn","Y_cn")
DT_scale<- cbind(DM.dt,Scale_DM)
#################Construction de T1 ###########################
DT_scale<-DT_scale[,':='(T1=(1/sqrt(0.84^2+0.84^2+0.71^2
+0.99^2+0.74^2))
*((-0.84*X1_cn)+(-0.84* X3_cn)+(-0.71*X4_cn)
+(0.99* X6_cn)+(-0.74* X7_cn)))]
#################Construction de T2 ###########################
# Regression y sur T1 et Xj j=1..7
#pour chercher les variables contribuant de mani�re sifnificatice
# � la construction de T2
lm11<-lm(formula = Y_cn ~ 0 + T1 + X1_cn, data=DT_scale)
print(summary(lm11))
lm12<-lm(formula = Y_cn ~ 0 + T1 + X2_cn, data=DT_scale)
print(summary(lm12))
lm13<-lm(formula = Y_cn ~ 0 + T1 + X3_cn, data=DT_scale)
print(summary(lm13))
lm14<-lm(formula = Y_cn ~ 0 + T1 + X4_cn, data=DT_scale)
print(summary(lm14))
lm15<-lm(formula = Y_cn ~ 0 + T1 + X5_cn, data=DT_scale)
print(summary(lm15))
lm16<-lm(formula = Y_cn ~ 0 + T1 + X6_cn, data=DT_scale)
print(summary(lm16))
lm17<-lm(formula = Y_cn ~ 0 + T1 + X7_cn, data=DT_scale)
print(summary(lm17))
# Seules les variables X2 et X6 sont significatives au risque 0.05
# On calcule les r�sidus X12 X16 des regressions de X2_nc, X6_nc sur T1
lm_R12<-lm(formula = X2_cn ~ 0 + T1  , data=DT_scale)
#### Extraction des r�sidus
X12<-resid(lm_R12)
lm_R16<-lm(formula = X6_cn ~ 0 + T1  , data=DT_scale)
#### Extraction des r�sidus
X16<-resid(lm_R16)
DT_scale<- cbind(DT_scale,X12,X16)
X12n<-X12/var(X12)
X16n<-X16/var(X16)
DT_scale<- cbind(DT_scale,X12n,X16n)
# Puis on effectue les deux r�gressions multiples
# Y_cn sur T1 et X1jn = x1j/var(x1j) j=2 et 6
lm_Y12<-lm(formula = Y_cn ~ 0 + T1 + X12n  , data=DT_scale)
lm_Y16<-lm(formula = Y_cn ~ 0 + T1 + X16n  , data=DT_scale)
print(summary(lm_Y12))
print(summary(lm_Y16))
DT_scale<-DT_scale[,':='(T2=(1/sqrt(0.19361^2+0.10067^2))*
((-0.19361*X12)+(0.10067*X16)))]
View(DT_scale)
View(DT_scale)
